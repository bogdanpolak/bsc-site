---
layout: javascript-playground
title: playground one
---

<div class="example" id="example-object-create">
	<div>
		<h1>Exercise: Object.create</h1>
	</div>
	<div class="example-content">
		<p class="reference"></p>
		<ul class="out"></ul>
	</div>
</div>

<div class="example" id="example-inheritance-before-ES6">
	<div>
		<h1>Exercise: Inheritance before ES6</h1>
	</div>
	<div class="example-content">
		<p class="reference">
			Mozilla: JavaScript Guide - Details of the object model
			[<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Details_of_the_Object_Model">czytaj wiecej</a>]
		</p>
		<ul class="out"></ul>
	</div>
</div>


<div class="example" id="example-closures">
	<div>
		<h1>Exercise Closures</h1>
	</div>
	<div class="example-content">
		<p class="reference">
			Mozilla: Creating closures in loops: A common mistake 
			[<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Closures#Creating_closures_in_loops_A_common_mistake">czytaj wiecej</a>]
		</p>
		<form action="">
			<p>
				<input type="radio" name="ex3-opt" value="using-var"> 
				wersja - var <span style="color:red;">(błędna)</span>  <span style="margin-left:30px;"></span>
				<input type="radio" name="ex3-opt" value="using-let"> 
				wersja - let  <span style="margin-left:30px;"></span>
				<input type="radio" name="ex3-opt" value="using-anonymous-closure"> 
				wersja - anonymous closure <span style="margin-left:30px;"></span>
				<input type="radio" name="ex3-opt" value="using-forEach"> 
				wersja - using-forEach
			</p>
			<p>E-mail: <input type="text" id="email" name="email"></p>
			<p>Name: <input type="text" id="name" name="name"></p>
			<p>Age: <input type="text" id="age" name="age"></p>
			<p id="help" style="color:rgb(176, 135, 0)">Helpful notes will appear here</p>
		</form>
	</div>
</div>

<div class="example" id="example-scope">
	<div>
		<h1>Exercise: JS Scope</h1>
	</div>
	<div class="example-content">
		<p class="reference"></p>
		<ul class="out"></ul>
	</div>
</div>

<div class="example" id="example-prototype">
	<div>
		<h1>Exercise: JS Prototype</h1>
	</div>
	<div class="example-content">
		<p class="reference">
			Blog post: Prototypes in JavaScript - Rupesh Mishra
			[<a href="https://hackernoon.com/prototypes-in-javascript-5bba2990e04b">czytaj wiecej</a>]
		</p>
		<ul class="out"></ul>
	</div>
</div>

<div class="example" id="example-object-has-property">
	<div>
		<h1>Exercise: Performance object has property</h1>
	</div>
	<div class="example-content">
		<p class="reference">
			How to check if an object has a property properly in javascript
			[<a href="https://ourcodeworld.com/articles/read/166/how-to-check-if-an-object-has-a-property-properly-in-javascript">czytaj wiecej</a>]
		</p>
		<ul class="out"></ul>
	</div>
</div>

<script>

/*
 * format unicorn function from StackOverflow
 * see: https://stackoverflow.com/questions/610406/javascript-equivalent-to-printf-string-format
 */
String.prototype.formatUnicorn = String.prototype.formatUnicorn || function () {
	"use strict";
	var str = this.toString();
	if (arguments.length) {
		var t = typeof arguments[0];
		var key;
		var args = ("string" === t || "number" === t) ?
			Array.prototype.slice.call(arguments)
			: arguments[0];
		for (key in args) {
			str = str.replace(new RegExp("\\{" + key + "\\}", "gi"), args[key]);
		}
	}
	return str;
};

/* -----------------------------------------------------------------------
 * HTML Loggers: ListLogger
 * ----------------------------------------------------------------------- */

const ListLogger = function (param) {
	if (typeof param.reportElemID === 'undefined')
		console.error ('property reportElemID is reqired in param object');
	const div = document.getElementById(param.reportElemID);
	this.out = div.getElementsByTagName('ul').item(0);
};
ListLogger.prototype.log = function (info, value) {
	var li=document.createElement('li');
	this.out.appendChild(li);
	li.innerHTML = info+' = '+value;
};

/* -----------------------------------------------------------------------
 * Exercises
 * ----------------------------------------------------------------------- */

const ex01_ObjectCreate = {
	run: function () {
		const logger = new ListLogger( {
			reportElemID: 'example-object-create'
		} );
		var foo = {
			x: 1,
			y: 2,
			fun1: function () {
				return this.x +this.y;
			}
		};
		const bar = Object.create(foo);
		logger.log ("foo.fun1()", foo.fun1() ); 
		logger.log ("bar.fun1()", bar.fun1() );
	}
};

const ex02_InheritanceBeforeES6 = {
	run: function () {
		const logger = new ListLogger( {
			reportElemID: 'example-inheritance-before-ES6'
		} );
		// ------------------------------------------
		// declare
		// ------------------------------------------
		// --- Employee class
		Employee = function  (name) {
			this.name = name || '';
			this.dept = 'general';
		};
		// --- Manager class (with explanations)
		Manager = function (name) {
			Employee.call(this,name);  // call Employee constructor
			this.reports = [];
		}
		Manager.prototype = Object.create(Employee.prototype);   // set prototype chain (this changes constructor to Person function)
		Manager.prototype.constructor = Manager;   // sets constructor again to Manager
		// --- Staff class
		Staff = function (name) {
			Employee.call(this,name);
			this.projects = [];
		}
		Staff.prototype = Object.create(Employee.prototype);
		Staff.prototype.constructor = Staff;
		// --- SalesStaff class
		function SalesStaff(name) {
			Staff.call(this,name);
			this.dept = 'sales';
			this.quota = 100;
		}
		SalesStaff.prototype = Object.create(Staff.prototype);
		SalesStaff.prototype.constructor = SalesStaff;
		// --- Engineer class
		function Engineer (name) {
			Staff.call(this,name);
			this.dept = 'engineering';
			this.machine = '';
		}
		Engineer.prototype = Object.create(Staff.prototype);
		Engineer.prototype.constructor = Engineer;
		// ------------------------------------------
		// construct objects
		// ------------------------------------------
		var jim = new Employee('Jim Bean');
		var sally = new Manager('Sally Reynolds');
		var mark = new Staff('Mark Doe');
			mark.dept = 'admin';
			mark.projects = [ 'NAV-navigator' ];
			mark.bonus = 3000;
		var fred = new SalesStaff;
		var jane = new Engineer;
		// ------------------------------------------
		logger.log('jim: Employee',JSON.stringify(jim));
		logger.log('sally: Manager',JSON.stringify(jim));
		logger.log('mark: Staff',JSON.stringify(mark));
		logger.log('fred: SalesStaff',JSON.stringify(fred));
		logger.log('jane: Engineer',JSON.stringify(jane));
	}
};

var ex03_ClosuresDemoUsingOnFocusEvent = {
	init: function () {
		const ex3div = document.getElementById('example-closures');
		const inputs = Array.prototype.slice.call(
			ex3div.getElementsByTagName('input'));
		inputs.forEach(e => {
			const me = this;
			if (e.type === 'radio') {
				e.onclick = function () { 
					me.onRadioClick(e.value);
				};
			};
		});
	},
	onRadioClick: function (radioValue) {
		var helpText = [
			{'id': 'email', 'help': 'Your e-mail address'},
			{'id': 'name', 'help': 'Your full name'},
			{'id': 'age', 'help': 'Your age (you must be over 16)'}
		];
		function setupHelp1_incorrect() {
			for (var i = 0; i < helpText.length; i++) {
				var item = helpText[i];
				document.getElementById(item.id).onfocus = function() {
					document.getElementById('help').innerHTML = item.help;
				}
			}
		}
		function setupHelp2() {
			for (var i = 0; i < helpText.length; i++) {
				let item = helpText[i];  // ***************
				document.getElementById(item.id).onfocus = function() {
					document.getElementById('help').innerHTML = item.help;
				}
			}
		}
		function setupHelp3() {
			for (var i = 0; i < helpText.length; i++) {
				document.getElementById(helpText[i].id).onfocus = (function(item) {
					return function () {
						document.getElementById('help').innerHTML = item.help;
					}
				})(helpText[i]);
			}
		}
		function setupHelp4() {
			helpText.forEach ( item => {
				document.getElementById(item.id).onfocus = function() {
					document.getElementById('help').innerHTML = item.help;
				}
			});
		}
		const setupFunctions = [ 
			{ name:"using-var", fun:setupHelp1_incorrect },
			{ name:"using-let", fun:setupHelp2 }, 
			{ name:"using-anonymous-closure", fun:setupHelp3 },
			{ name:"using-forEach", fun:setupHelp4 },
			 
		];
		const items = setupFunctions.filter ( e => e.name === radioValue );
		items.forEach ( item => { 
			item.fun(); 
			console.log('function: '+item.fun.name); 
		} );
	}
};

ex4object = {};
ex4fn = function(){ 
	return this; 
};

ex04_ScopeAndCall = {
	run: function() {
		const logger = new ListLogger( {
			reportElemID: 'example-scope'
		} );
		logger.log ( "(ex4fn() == this) ", ex4fn() == window );
		logger.log( "(ex4fn.call(ex4object) == ex4object) ", ex4fn.call(ex4object) == ex4object );
	}
};

function MyClass (a) {
	this.a = a;
	this.b = 1;
}
MyClass.prototype.sum = function () {
	return this.a +this.b;
}

ex05_AddFunctionToPrototype = {
	run: function() {
		const logger = new ListLogger( {
			reportElemID: 'example-prototype'
		} );
		const obj = new MyClass(5);
		logger.log( "obj.sum() ", obj.sum() );
	}
}

ex06_TestObjectPropertyPerformance = {
	__run_test: function (iterations, isSetPropertyValue, propValue) {
		var start, obj, result, results = [];
		// ----------------------------------
		// test one:
		var iters = iterations;
		start = new Date;
		do {
			obj = {};
			if (isSetPropertyValue) obj.prop = propValue;
			for (var i = 0; i < 100; ++i)
				result = (typeof obj.prop !== 'undefined');
		} while (iters--);
		results.push ( {testName:'typeof obj.prop !== undefined', time: new Date - start} );
		// ----------------------------------
		// test one:
		var iters = iterations;
		start = new Date;
		do {
			obj = {};
			if (isSetPropertyValue) obj.prop = propValue;
			for (var i = 0; i < 100; ++i)
				result = ('prop' in obj);
		} while (iters--);
		results.push ( {testName:'prop in obj', time: new Date - start} );
		// ----------------------------------
		// test one:
		var iters = iterations;
		start = new Date;
		do {
			obj = {};
			if (isSetPropertyValue) obj.prop = propValue;
			for (var i = 0; i < 100; ++i)
				result = (obj.hasOwnProperty('prop'));
		} while (iters--);
		results.push ( {testName:'obj.hasOwnProperty', time: new Date - start} );
		return results;
	},
	run : function () {
		const logger = new ListLogger( {
			reportElemID: 'example-object-has-property'
		} );
		res = this.__run_test(500000, true, 1);
		for (obj of res) {
			logger.log ('[ '+obj.testName+' ]  (enlapsed ms)',obj.time);
		}
	}
}

;(function(){
	ex01_ObjectCreate.run();
	ex02_InheritanceBeforeES6.run();
	ex03_ClosuresDemoUsingOnFocusEvent.init();
	ex04_ScopeAndCall.run();
	ex05_AddFunctionToPrototype.run();
	ex06_TestObjectPropertyPerformance.run();
})();

</script>